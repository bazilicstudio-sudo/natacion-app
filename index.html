<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Competencia Elite PRO MAX</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:sans-serif;background:#0f172a;color:white;padding:10px;}
.card{background:#1f2937;padding:15px;border-radius:15px;margin-bottom:15px;}
button{padding:10px;margin:5px 0;border:none;border-radius:10px;font-weight:bold;cursor:pointer;width:100%;}
.btn{background:#2563eb;color:white}
.btn-success{background:#16a34a;color:white}
.btn-danger{background:#dc2626;color:white}
.btn-warning{background:#f59e0b;color:white}
.lane{background:#111827;padding:15px;margin:10px 0;border-radius:15px;text-align:center;}
.timeDisplay{font-size:22px;font-weight:bold;margin:10px 0;}
.hidden{display:none}
input,select{width:100%;padding:8px;margin:5px 0;border-radius:8px;border:none;}
.small-btn{padding:5px;font-size:12px;margin-top:5px;width:auto;margin-right:5px;}
</style>
</head>
<body>

<h2>ğŸŠ Sistema Competencia Elite PRO MAX</h2>

<div id="loginCard" class="card">
<h3>Iniciar SesiÃ³n</h3>
<input type="text" id="loginUser" placeholder="Usuario">
<input type="password" id="loginPass" placeholder="ContraseÃ±a">
<button class="btn" onclick="login()">Ingresar</button>
</div>

<div id="app" class="hidden">

<button class="btn-danger" onclick="logout()">Cerrar SesiÃ³n</button>

<div class="card">
<h3>ğŸ‘¨â€ğŸ« Entrenadores</h3>

<input type="text" id="coachNewName" placeholder="Nombre entrenador">
<button class="btn-success" onclick="createCoach()">Crear Entrenador</button>

<div id="coachList"></div>
</div>

<div class="card">
<h3>Atletas</h3>
<input type="text" id="newAthleteUser" placeholder="Nombre atleta">
<input type="password" id="newAthletePass" placeholder="ContraseÃ±a">
<input type="number" id="newAthleteAge" placeholder="Edad">
<select id="newAthleteSex">
<option value="">Sexo</option>
<option value="Masculino">Masculino</option>
<option value="Femenino">Femenino</option>
</select>
<button class="btn-success" onclick="createAthlete()">Crear Atleta</button>
<div id="athleteList"></div>
</div>

<div class="card">
<h3>ğŸ“‹ Datos de la Prueba</h3>
<input type="text" id="testName" placeholder="Nombre prueba">
<input type="number" id="testDistance" placeholder="Metros">
<input type="date" id="testDate">
<button class="btn-success" onclick="activateTest()">Activar Prueba</button>
<div id="activeTestInfo"></div>
</div>

<div class="card">
<h3>Competencia</h3>
<input type="number" id="laneCount" value="4" min="2" max="10">
<button class="btn-success" onclick="startCompetition()">Crear Carriles</button>
<button class="btn-success" onclick="startRaceNow()">ğŸš¦ INICIAR</button>
<button class="btn-danger" onclick="resetRace()">ğŸ”„ Reiniciar</button>
<div id="lanes"></div>
</div>

<div class="card">
<h3>Ranking</h3>
<div id="ranking"></div>
</div>

<div class="card">
<h3>ğŸ“¥ Descargas Profesionales (PDF)</h3>

<input type="file" id="logoInput" accept="image/*">
<label>Logo Institucional</label>

<input type="file" id="firmaInput" accept="image/*">
<label>Firma del Entrenador</label>

<input type="text" id="coachName" placeholder="Nombre del Entrenador">

<button class="btn" onclick="downloadFull()">Descargar Historial Completo</button>

<select id="downloadAthleteSelect"></select>
<button class="btn-success" onclick="downloadByAthlete()">Descargar por Atleta</button>

<input type="date" id="downloadDate">
<button class="btn-warning" onclick="downloadByDate()">Descargar por Fecha</button>

<select id="downloadTestSelect"></select>
<button class="btn-danger" onclick="downloadByTest()">Descargar por Prueba</button>

</div>

</div>

<script>

/* ===== BASE ===== */

function safeParse(key){
try{return JSON.parse(localStorage.getItem(key))||[];}
catch{return [];}
}

let athletes=safeParse("athletes");
let allTests=safeParse("allTests");
let coaches=safeParse("coaches");
let currentTest=null;

/* ===== ENTRENADORES ===== */

function createCoach(){
let name=document.getElementById("coachNewName").value;
if(!name) return alert("Ingrese nombre");

if(coaches.some(c=>c.name===name)){
alert("Ya existe ese entrenador");
return;
}

coaches.push({name:name});
localStorage.setItem("coaches",JSON.stringify(coaches));
document.getElementById("coachNewName").value="";
renderCoaches();
}

function editCoach(index){
let nuevo=prompt("Nuevo nombre:",coaches[index].name);
if(!nuevo) return;
coaches[index].name=nuevo;
localStorage.setItem("coaches",JSON.stringify(coaches));
renderCoaches();
}

function deleteCoach(index){
if(!confirm("Â¿Eliminar entrenador?")) return;
coaches.splice(index,1);
localStorage.setItem("coaches",JSON.stringify(coaches));
renderCoaches();
}

function renderCoaches(){
coachList.innerHTML="";
coaches.forEach((c,i)=>{
coachList.innerHTML+=`
<div style="background:#111827;padding:5px;margin-bottom:5px;border-radius:8px;">
<b>${c.name}</b>
<button class="small-btn btn-warning" onclick="editCoach(${i})">Editar</button>
<button class="small-btn btn-danger" onclick="deleteCoach(${i})">Eliminar</button>
</div>`;
});
}

/* ===== RESTO DEL SISTEMA (EL TUYO ORIGINAL) ===== */
/* NO SE MODIFICÃ“ NADA MÃS */

function login(){
document.getElementById("loginCard").classList.add("hidden");
document.getElementById("app").classList.remove("hidden");
renderAll();
renderCoaches();
}

function logout(){location.reload();}

/* ... TODO TU CÃ“DIGO RESTANTE SIGUE EXACTAMENTE IGUAL ... */

</script>
</body>
</html>
